<html>
    <head>
        <title>Autocompletion</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script src="https://unpkg.com/htmx.org@1.9.6" integrity="sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    </head>
    
    <body>
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col col-lg-12">
                    <h1>Autocompletion System</h1>
                       <input id="searchBox" class="form-control" type="search" 
                           name="prefix" placeholder="Begin Typing To Search Users..." 
                           hx-get="http://172.26.111.126:8000/app/suggestion" 
                           hx-trigger="keyup changed delay:500ms, prefix"
                           hx-target="#response">
                </div>
            </div>
        </div>
        
        <div class="container">
            <p id="response"></p>
            <div id="resultContainer" class="border mx-4 p-4 bg-light"></div>
        </div>

    </body>
    
    <script>
        document.getElementById("searchBox").addEventListener("htmx:afterRequest", function(event) {
            const resultContainer = document.getElementById("resultContainer");

            if (resultContainer.innerText !== "") {
                resultContainer.innerText = ""
            }

            const existedContainer = document.getElementById("response");
           
            const items = JSON.parse(existedContainer.innerHTML.split(",").map(String));
            existedContainer.innerHTML = ""

            items.forEach(element => {
                const pTag = document.createElement("p");
                pTag.textContent = element
                resultContainer.appendChild(pTag)
            });
        })
    </script>
</html>